<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

  
    // Initialize Firebase

  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  document.getElementById("loginBtn").addEventListener("click", () => {
    signInWithPopup(auth, provider)
      .then((result) => result.user.getIdToken())
      .then((idToken) => {
        return fetch("/auth/firebase", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ token: idToken })
        });
      })
      .then(res => res.json())
      .then(data => {
        console.log("Backend verified:", data);
        if (data.status === "success") {
          window.location.href = data.redirect;  // go to dashboard.html
        }
      })
      .catch((error) => console.error("Login failed:", error));
  });

</script>


<button id="loginBtn">Login with Google</button>